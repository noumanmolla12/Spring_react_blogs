<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="admin/layout :: layout">
<body>

<div th:fragment="content">
    <div class="container py-4">

        <h2 class="mb-4" th:text="${post.id != null} ? 'Edit Post' : 'Add New Post'"></h2>

        <form th:action="@{/admin/posts/save}" method="post" th:object="${post}" enctype="multipart/form-data" class="border p-4 rounded bg-light">
            <input type="hidden" th:field="*{id}" />

            <div class="mb-3">
                <label for="title" class="form-label">Title</label>
                <input id="title" type="text" class="form-control" th:field="*{title}" required />
            </div>

            <div class="mb-3">
                <label for="slug" class="form-label">Slug</label>
                <input id="slug" type="text" class="form-control" th:field="*{slug}" readonly />
            </div>

            <div class="mb-3">
                <label for="content" class="form-label">Content</label>
                <textarea id="content" class="form-control" rows="5" th:field="*{content}" required></textarea>
            </div>

            <div class="mb-3">
                <label for="category" class="form-label">Category</label>
                <select id="category" class="form-select" th:field="*{category.id}">
                    <option value="">-- Select Category --</option>
                    <option th:each="cat : ${categories}"
                            th:value="${cat.id}"
                            th:text="${cat.name}"
                            th:selected="${cat.id == post.category?.id}">
                    </option>
                </select>
            </div>

            <div class="mb-3">
                <div th:if="${post.imageName != null}">
                    <img th:src="@{'/uploads/' + ${post.imageName}}" alt="Uploaded Image"
                         class="img-thumbnail mb-2" width="150" height="100" style="object-fit: cover;" />
                </div>
                <label for="imageFile" class="form-label">Image</label>
                <input type="file" id="imageFile" name="imageFile" class="form-control" />
            </div>

            <div class="form-check form-switch mb-3">
                <input type="checkbox" class="form-check-input" id="featured" th:field="*{featured}" />
                <label class="form-check-label" for="featured">Featured</label>
            </div>

            <div class="form-check form-switch mb-3">
                <input type="checkbox" class="form-check-input" id="active" th:field="*{active}" />
                <label class="form-check-label" for="active">Active</label>
            </div>

            <button type="submit" class="btn btn-primary">Save Post</button>
        </form>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", function () {
        const titleInput = document.getElementById("title");
        const slugInput = document.getElementById("slug");

        titleInput.addEventListener("input", function () {
            const slug = titleInput.value.toLowerCase().trim()
                .replace(/[^a-z0-9]+/g, '-')
                .replace(/^-+|-+$/g, '');
            slugInput.value = slug;
        });
    });
</script>
</div>

<!-- âœ… Automatic Slug Generator -->


</body>
</html>